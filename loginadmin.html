<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>loginAdmin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
  </head>

  <body>
    <div class="container" style="margin-top: 40px">
      <h1>Login Admin</h1>
      <div id="error" style="color: red; height: 10px"></div>
      <br />
      <form action="" method="post" name="myform" id="myform">
        <div class="form-group">
          <input
            type="text"
            class="form-control"
            style="width: 50%"
            placeholder="Username"
            name="username"
            id="username"
            required
          />
        </div>
        <br />
        <div class="form-group">
          <input
            type="password"
            class="form-control"
            style="width: 50%"
            placeholder="Password"
            name="password"
            id="password"
            required
          />
        </div>
        <br />
        <input class="btn btn-success" type="submit" value="Login" />
      </form>
    </div>
    <script>
      document.getElementById("myform").addEventListener("submit", (e) => {
        e.preventDefault();
        var name = document.myform.username.value;
        var password = document.myform.password.value;

        var postAPI = "https://seedschool.herokuapp.com/api/v1/account/login";

        fetch(postAPI, {
          method: "POST",
          body: JSON.stringify({
            username: name,

            password: password,
          }),
          headers: {
            "Content-type": "application/json; charset=UTF-8",
          },
        })
          .then(function (response) {
            return response.json();
          })
          .then(function (posts) {
            console.log(posts);
            if (!posts.token) {
              document.getElementById("error").innerHTML =
                "Incorrect username or password";
              document.getElementById("username").focus();
            } else {
              alert("Login successfully!");
              localStorage.setItem("token", posts.token);
              window.location.replace("./admin/admin-index.html");
            }
          })
          .catch((error) => console.log(error));
      });
    </script>
  </body>
</html>
